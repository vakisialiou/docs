### Что такое Dockerfile и как его использовать?

**Dockerfile** — это текстовый файл, содержащий инструкции для сборки Docker-образа. Он позволяет автоматизировать
создание образов, определяя шаги, необходимые для установки и настройки приложения, его зависимостей и окружения.
На основе этих инструкций Docker создаёт конечный образ, который можно использовать для развертывания приложения
в контейнере.

#### Основные инструкции Dockerfile:

1. **FROM:** Определяет базовый образ, от которого будет построен новый образ. Это первый шаг в любом `Dockerfile`.
    ```bash 
    FROM node:18 
    ```
2. **WORKDIR:** Устанавливает рабочую директорию внутри контейнера. Все последующие команды будут выполняться
   относительно этой директории.
    ```bash 
    WORKDIR /app 
    ```
3. **COPY:** Копирует файлы или директории с вашей машины в контейнер.
    ```bash 
    COPY package.json .
    ```
4. **RUN:** Выполняет команду во время сборки образа (например, установка зависимостей, сборка приложения).
    ```bash 
    RUN npm install
    ```
5. **CMD:** Определяет команду, которая будет выполнена при запуске контейнера. В отличие от `RUN`, эта команда
   выполняется при запуске контейнера, а не на этапе сборки образа.
    ```bash 
    CMD ["npm", "start"]
    ```
6. **EXPOSE:** Указывает, что контейнер прослушивает указанный порт (но на практике нужно явно маппить порты при запуске).
    ```bash 
    EXPOSE 3000
    ```
7. **ENV:** Устанавливает переменные окружения внутри контейнера.
    ```bash 
    ENV NODE_ENV=production
    ```
8. **ENTRYPOINT:** Позволяет задать команду, которая будет выполнена при запуске контейнера. В отличие от `CMD`,
   она не может быть переопределена при запуске контейнера.
    ```bash 
    ENTRYPOINT ["npm", "start"]
    ```

#### Пример простого Dockerfile:

```bash
# Базовый образ с Node.js 18
FROM node:18

# Устанавливаем рабочую директорию внутри контейнера
WORKDIR /app

# Копируем файл package.json в контейнер в директорию /app
COPY package.json .

# Устанавливаем зависимости
RUN npm install

# Копируем все файлы проекта в контейнер
COPY . .

# Указываем порт, который будет использовать приложение
EXPOSE 3000

# Запускаем приложение
CMD ["npm", "start"]
```

#### Как использовать Dockerfile

1. **Создание Dockerfile:** Создайте файл с именем Dockerfile в корневой директории вашего проекта и добавьте 
в него инструкции, как показано в примере выше.
2. **Сборка Docker-образа:** Используя команду docker build, вы можете создать образ на основе инструкций из 
Dockerfile.
    ```bash
    docker build -t my-app .
    ```
   - `-t my-app` задаёт имя образа.
   - `.` указывает на текущую директорию, в которой находится Dockerfile.
3. **Запуск контейнера:** После сборки образа вы можете запустить контейнер.
    ```bash
    docker run -d -p 8080:3000 my-app
    ```
   - `-d` запускает контейнер в фоновом режиме.
   - `-p 8080:3000` перенаправляет порт `3000` контейнера на порт `8080` хоста.
4. **Просмотр запущенных контейнеров:** Используйте команду `docker ps`, чтобы увидеть список всех запущенных контейнеров.
    ```bash
    docker ps
    ```
5. **Просмотр запущенных контейнеров в реальном времени:** - можно мониторить использование ресурсов контейнерами, 
таких как процессор, память, диск и сеть.
    ```bash
    docker stats
    ```
6. **Остановка контейнера:** Чтобы остановить контейнер, используйте команду `docker stop` с идентификатором контейнера
    ```bash
    docker stop <container_id>
    ```
7. **Принудительное завершение контейнера:** Если контейнер не завершает работу корректно при использовании команды `stop`, 
можно принудительно завершить его с помощью
    ```bash
    docker kill <container_id or container_name>
    ```

### Чем отличается команда CMD от ENTRYPOINT в Dockerfile?

1. Назначение
   - **CMD:** Команда по умолчанию, которая может быть переопределена при запуске контейнера.
   - **ENTRYPOINT:** Основная команда, которая всегда будет выполнена при запуске контейнера, а переданные аргументы дополняют её.
